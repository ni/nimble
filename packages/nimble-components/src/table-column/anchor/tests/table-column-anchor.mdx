import { Controls, Canvas, Meta, Title } from '@storybook/blocks';
import TargetDocs from '../../../patterns/anchor/tests/target-docs.mdx';
import * as tableColumnAnchorStories from './table-column-anchor.stories';
import { tableColumnAnchorTag } from '..';
import { tableTag } from '../../../table';

<Meta of={tableColumnAnchorStories} />
<Title of={tableColumnAnchorStories} />

The <Tag name={tableColumnAnchorTag}/> column is used to display string fields as links or text in the <Tag name={tableTag}/>. If a row provides an href for a link, that cell will display a link, otherwise it will display plain text.

<Canvas of={tableColumnAnchorStories.anchorColumn} />
<Controls of={tableColumnAnchorStories.anchorColumn} />

## Usage

### Best Practices

-   Provide useful labels for well known urls. While an absent label will show the full URL for accessibility, it is useful to instead provide a clear and unique label to improve grouping.
    -   For example, a column of links to notebooks where a notebook may no longer exist, and thus a label is not available, could pre-process the notebook urls and create the label `Missing Notebook (UNIQUE_NOTEBOOK_ID)`. This allows multiple rows referencing the same missing notebook to be grouped together.
    -   Alternatively if the urls are not well-known structures, the application should explicitly provide the href as the label to keep unique labels and preserve grouping as opposed to using `null` / `undefined` labels.
-   Applications should avoid having duplicate labels to different hrefs as those are inaccessible to screen readers (and sighted users). See [high-level discussion](https://fae.disability.illinois.edu/rulesets/LINK_2/) of [aria SC 2.4.4](https://www.w3.org/TR/WCAG22/#link-purpose-in-context).
    -   For example, applications should avoid having `undefined` / `null` as the label as that causes multiple unrelated URLs to be grouped together under the group label "No value". Accessibility is okay as the full url will be shown but the value of grouping is limited.
    -   For example, if a label is missing, an application should avoid generating a non-unique label for multiple URLs (i.e. `Missing Notebook`) as that harms accessibility and limits the value of grouping.
-   Avoid using empty string or other whitespace-only labels with defined hrefs. This will cause the rendered anchor to have no text associated with it, and it will be difficult for a user to see that the anchor exists.
-   Applications may leave the href as `null` / `undefined` to have the anchor column behave effectively like a string column
-   Avoid mixing `undefined` and `null` as values for the label field. When grouping this will lead to two groups (one for `null` values and one for `undefined` values) that both have the text `"No value"`.
    -   As explained above, it is not recommended to use `undefined` or `null` labels when the data has defined hrefs.
-   Avoid mixing empty string with `undefined`/`null` as values for the label field. The distinction when grouping between `"No value"` and `"Empty"` is not likely meaningful to a user.
    -   As explained above, it is not recommended to use empty string, `undefined`, or `null` labels when the data has defined hrefs.

### Target Configuration

<TargetDocs />

### Angular Usage

In an Angular app, you can configure a callback to intercept clicks so that you may invoke the router to perform the navigation instead of the default handler:

```html
<nimble-table-column-anchor [navigationGuard]="doRouterNavigation">
    Link
</nimble-table-column-anchor>
```

The function bound to `navigationGuard` should be of type `NavigationGuard`. It receives the clicked row id and should return a boolean indicating whether the default click handler should be run. I.e. return `false` if you have handled the navigation. The function is only called for left clicks with no modifier keys pressed.
