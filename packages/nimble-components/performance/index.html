<!DOCTYPE html>
<html>
<head>
    <script src="../nimble-components/dist/all-components-bundle.min.js"></script>
    <script src="../dist/all-components-bundle.min.js"></script>
</head>
<body>
    <h1>Wafer Map Performance Tests</h1>
    <script>
        document.addEventListener('DOMContentLoaded', main);
        
        const colorScales = {
            colors: ['red', 'orange', 'yellow', 'green'],
            values: ['1', '33', '66', '100']
        };

        async function createWaferMap(functionName, dieCount) {
            waferMapDies = generateDies(dieCount).wafermapDieSet;
            performance.mark(`${functionName}_start`);
            const waferMap = document.createElement('nimble-wafer-map');
            waferMap.dies = waferMapDies
            waferMap.colorScale = colorScales;
            document.body.appendChild(waferMap);
            await new Promise(requestAnimationFrame);
            performance.mark(`${functionName}_end`);
            performance.measure(functionName, `${functionName}_start`, `${functionName}_end`);
        }
        
        async function main() {
            await createWaferMap('smallSizeWafer', 10 ** 4);
            await createWaferMap('mediumSizeWafer', 10 ** 5);
            await createWaferMap('largeSizeWafer', 10 ** 6);
        }
        
        function generateDies(diesCount) {
            const wafermapDieSet = [];
            const sideLength = Math.floor(Math.sqrt(diesCount / Math.PI) * 2);
            const radius = sideLength / 2;
            const centerX = Math.floor(sideLength / 2);
            const centerY = centerX;
            for (let i = 0; i <= sideLength; i++) {
                for (let j = 0; j <= sideLength; j++) {
                    const distance = Math.sqrt((i - centerX) ** 2 + (j - centerY) ** 2);
                    if (distance <= radius) {
                        wafermapDieSet.push({ x: i, y: j, value: ((i + j) % 100).toString() });
                    }
                }
            }
            return { wafermapDieSet };
        }
</script>
</body>
</html>
